<script>
    function loadJssdk(res){
        wx.config({
            debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
            appId: res.datas.appId, // 必填，公众号的唯一标识
            timestamp: res.datas.timestamp, // 必填，生成签名的时间戳
            nonceStr: res.datas.noncestr, // 必填，生成签名的随机串
            signature: res.datas.signature, // 必填，签名，见附录1
            jsApiList: ['onMenuShareTimeline', 'onMenuShareAppMessage','getLocation','openLocation','previewImage'] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2
        });
        wx.ready(()=>{

        });
    }
    function getWxJssdk(){
        fetch("/initWx?url="+location.href,{
            method:"GET",
        }).then((res)=>{
            return res.json();
        }).then(function(res){
            if(res.status == 1){
                loadJssdk(res)
            }
        })
    }
    getWxJssdk();
    function pay(){
        fetch("/admin/customer",{
            method:"PUT",
            body: JSON.stringify({
                cradID:$(".cradID").val(),
                name:$(".name").val()
            }),
            headers:{
                'Accept':'application/json',
                'Content-Type':'application/json'
            }
        }).then((res)=>{
            return res.json();
        }).then(function(res){
            console.log(res)
            if(res.status == 1){
                isWeixinOrAlipay()
            }
        })
    }
    function isWeixinOrAlipay(){
        var ua = navigator.userAgent.toLowerCase();
        if(ua.match(/MicroMessenger/i)=="micromessenger") {
            console.log('微信浏览器');
        } else if(ua.match(/AlipayClient/i)=="alipayclient"){
            console.log('支付宝浏览器');
            window.location.href= "HTTPS://QR.ALIPAY.COM/FKX067208J6GJ1KK9HJB32";
        }else{
            console.log('其他浏览器');
        }
    }
</script>
</body>
</html>